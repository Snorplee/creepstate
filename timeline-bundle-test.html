<!DOCTYPE html>
<html>
<head>
    <title>SIMILE Timeline Bundle Test</title>
    
    <!-- Load SIMILE Timeline Bundle (includes Ajax API) -->
    <link rel="stylesheet" type="text/css" href="simile-timeline/api/timeline-bundle.css">
    <script src="simile-timeline/api/timeline-bundle.js"></script>
    
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        #timeline { height: 400px; border: 2px solid #333; background: white; }
        .log { background: #f0f0f0; padding: 10px; margin: 10px 0; font-family: monospace; }
    </style>
</head>
<body>
    <h1>SIMILE Timeline Bundle Test</h1>
    <div id="log" class="log">Testing SIMILE Timeline Bundle...</div>
    <div id="timeline"></div>
    
    <script>
        function log(message) {
            const logDiv = document.getElementById('log');
            logDiv.innerHTML += '<br>' + new Date().toISOString() + ': ' + message;
            console.log(message);
        }
        
        window.addEventListener('load', function() {
            setTimeout(function() {
                try {
                    log('Testing Timeline API availability...');
                    log('SimileAjax: ' + typeof SimileAjax);
                    log('Timeline: ' + typeof Timeline);
                    
                    if (typeof Timeline === 'undefined') {
                        log('‚ùå Timeline API not available');
                        return;
                    }
                    
                    log('Timeline.DefaultEventSource: ' + typeof Timeline.DefaultEventSource);
                    log('Timeline.create: ' + typeof Timeline.create);
                    log('Timeline.DateTime: ' + typeof Timeline.DateTime);
                    
                    if (typeof Timeline.DefaultEventSource !== 'function') {
                        log('‚ùå Timeline.DefaultEventSource is not a constructor');
                        return;
                    }
                    
                    // Create event source
                    const eventSource = new Timeline.DefaultEventSource();
                    log('‚úÖ Event source created');
                    
                    // Add a simple test event
                    const testEvent = new Timeline.DefaultEventSource.Event({
                        start: new Date(2020, 0, 1),
                        instant: true,
                        text: "Test Event 2020",
                        description: "This is a test event for 2020"
                    });
                    eventSource.add(testEvent);
                    log('‚úÖ Test event added');
                    
                    // Create timeline bands
                    const bandInfos = [
                        Timeline.createBandInfo({
                            eventSource: eventSource,
                            date: new Date(2020, 0, 1),
                            width: "70%",
                            intervalUnit: Timeline.DateTime.MONTH,
                            intervalPixels: 100
                        }),
                        Timeline.createBandInfo({
                            eventSource: eventSource,
                            date: new Date(2020, 0, 1),
                            width: "30%",
                            intervalUnit: Timeline.DateTime.YEAR,
                            intervalPixels: 200,
                            overview: true
                        })
                    ];
                    
                    // Sync bands
                    bandInfos[1].syncWith = 0;
                    bandInfos[1].highlight = true;
                    
                    log('‚úÖ Band configurations created');
                    
                    // Create timeline
                    const timeline = Timeline.create(document.getElementById("timeline"), bandInfos);
                    log('üéâ SIMILE Timeline created successfully!');
                    
                    if (timeline) {
                        log('‚úÖ Timeline object is valid');
                        
                        // Try to center timeline
                        timeline.getBand(0).setCenterVisibleDate(new Date(2020, 0, 1));
                        log('‚úÖ Timeline centered on 2020');
                    } else {
                        log('‚ùå Timeline object is null');
                    }
                    
                } catch (error) {
                    log('‚ùå Error: ' + error.message);
                    log('‚ùå Stack: ' + error.stack);
                }
            }, 1000);
        });
    </script>
</body>
</html>